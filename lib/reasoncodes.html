<!doctype html>

<html lang="en">
<head>
    <title>NPS Reason Codes</title>
    <style>
	h1{
	    font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	    font-size: 30px;
	    color: #003399
	    background: #fff;
	    margin: 15px;
	    margin-left:45px;
	    text-align: left;
	}

	table
	{
		font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
		font-size: 12px;
		background: #fff;
		margin: 45px;
                margin-top: 15px;
		width: 480px;
		border-collapse: collapse;
		text-align: left;
	}
	table th
	{
		font-size: 14px;
		font-weight: normal;
		color: #039;
		padding: 10px 8px;
		border-bottom: 2px solid #6678b1;
	}
	table td
	{
		border-bottom: 1px solid #ccc;
		color: #669;
		padding: 6px 8px;
	}
	table tbody tr:hover td
	{
		color: #009;
  }
 
</style>
</head>
<body>
    <h1>NPS Reason Codes</h1>
    <table>
            <tr>
              <th>
Reason Code
</th>
              <th>
Description
</th>
            </tr>
            <tr>
              <td>
                <p>0</p>
              </td>
              <td>
                <p>The connection request was successfully authenticated and authorized by Network Policy Server.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>1</p>
              </td>
              <td>
                <p>The connection request failed due to a Network Policy Server error.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>2</p>
              </td>
              <td>
                <p>There are insufficient access rights to process the request.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>3</p>
              </td>
              <td>
                <p>The Remote Authentication Dial-In User Service (RADIUS) Access-Request message that NPS received from the network access server was malformed.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>4</p>
              </td>
              <td>
                <p>The NPS server was unable to access the Active Directory Domain Services (AD DS) global catalog. Because of this, authentication and authorization for the connection request cannot be performed, and access is denied.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>5</p>
              </td>
              <td>
                <p>The Network Policy Server was unable to connect to a domain controller in the domain where the user account is located. Because of this, authentication and authorization for the connection request cannot be performed, and access is denied.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>6</p>
              </td>
              <td>
                <p>The NPS server is unavailable. This issue can occur if the NPS server is running low on or is out of random access memory (RAM). It can also occur if the NPS server fails to receive the name of a domain controller, if there is a problem with the Security Accounts Manager (SAM) database on the local computer, or in circumstances where there is a Windows NT directory service (NTDS) failure.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>7</p>
              </td>
              <td>
                <p>The domain that is specified in the User-Name attribute of the RADIUS message does not exist.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>8</p>
              </td>
              <td>
                <p>The user account that is specified in the User-Name attribute of the RADIUS message does not exist.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>9</p>
              </td>
              <td>
                <p>An Internet Authentication Service (IAS) extension dynamic link library (DLL) that is installed on the NPS server discarded the connection request.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>10</p>
              </td>
              <td>
                <p>An IAS extension dynamic link library (DLL) that is installed on the NPS server has failed and cannot perform its function.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>16</p>
              </td>
              <td>
                <p>Authentication failed due to a user credentials mismatch. Either the user name provided does not match an existing user account or the password was incorrect.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>17</p>
              </td>
              <td>
                <p>The user's attempt to change their password has failed.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>18</p>
              </td>
              <td>
                <p>The authentication method used by the client computer is not supported by Network Policy Server for this connection.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>19</p>
              </td>
              <td>
                <p>Challenge Handshake Authentication Protocol (CHAP) is being used as the authentication method for the connection request, however CHAP is not configured to store a reversibly encrypted form of user passwords. </p>
                <p>With CHAP, reversibly encrypted password storage is required. You can enable reversibly encrypted password storage per user account or for all accounts in a domain using Group Policy. To enable reversibly encrypted password storage for a user account, obtain the properties of a user account in AD DS, click the <strong>Account</strong> tab, and then select the <strong>Store password using reversible encryption</strong> check box. </p>
                <p>To allow reversibly encrypted password storage for all user accounts in the domain, add the Group Policy Management Editor snap-in to the Microsoft Management Console (MMC) and enable the default domain policy setting <strong>Store password using reversible encryption</strong> at the following path: Computer Configuration | Policies | Windows Settings | Security Settings | Account Policies | Password Policies.
</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>20</p>
              </td>
              <td>
                <p>The client attempted to use LAN Manager authentication, which is not supported by Network Policy Server. To enable the use of LAN Manager authentication, see <a href="http://technet.microsoft.com/en-us/library/dd197538(v=ws.10).aspx">NPS: LAN Manager Authentication</a>.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>21</p>
              </td>
              <td>
                <p>An IAS extension dynamic link library (DLL) that is installed on the NPS server rejected the connection request.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>22</p>
              </td>
              <td>
                <p>Network Policy Server was unable to negotiate the use of an Extensible Authentication Protocol (EAP) type with the client computer.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>23</p>
              </td>
              <td>
                <p>An error occurred during the Network Policy Server use of the Extensible Authentication Protocol (EAP). Check EAP log files for EAP errors. By default, these log files are located at <strong>%windir%\System32\Logfiles</strong>.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>32</p>
              </td>
              <td>
                <p>NPS is joined to a workgroup and performs the authentication and authorization of connection requests using the local Security Accounts Manager database, however the Access-Request message contains a domain user name. NPS does not have access to a domain user accounts database. The connection request was denied.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>33</p>
              </td>
              <td>
                <p>The user that is attempting to connect to the network must change their password.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>34</p>
              </td>
              <td>
                <p>The user account that is specified in the RADIUS Access-Request message is disabled.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>35</p>
              </td>
              <td>
                <p>The user account that is specified in the RADIUS Access-Request message is expired.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>36</p>
              </td>
              <td>
                <p>The user's authentication attempts have exceeded the maximum allowed number of failed attempts specified by the <strong>Account lockout threshold</strong> setting in <strong>Account Lockout Policy</strong> in Group Policy. To unlock the account, obtain the user account properties in the Active Directory Users and Computers Microsoft Management Console (MMC) snap-in, click the <strong>Account</strong> tab, and then click <strong>Unlock account</strong>.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>37</p>
              </td>
              <td>
                <p>According to AD DS user account logon hours, the user is not permitted to access the network on this day and time. To change the account logon hours, obtain the user account properties in the Active Directory Users and Computers snap-in, click the <strong>Account</strong> tab, and then click <strong>Logon Hours</strong>. In the <strong>Logon Hours</strong> dialog box, configure the days and times when the user is permitted to access the network.</p>
              </td>
            </tr>
              <tr>
              <td>
                <p>38</p>
              </td>
              <td>
                <p>Authentication failed due to a user account restriction or requirement that was not followed. For example, the user account settings might require the use of a password but the user attempted to log on with a blank password. To resolve this issue, check the user account properties for restrictions, and then either remove or modify the restrictions or inform the user of the requirements for network access.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>48</p>
              </td>
              <td>
                <p>The connection request did not match a configured network policy, so the connection request was denied by Network Policy Server.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>49</p>
              </td>
              <td>
                <p>The connection request did not match a configured connection request policy, so the connection request was denied by Network Policy Server.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>64</p>
              </td>
              <td>
                <p>Remote Access Account Lockout is enabled, and the user's authentication attempts have exceeded the designated lockout count because the credentials they supplied (user name and password) are not valid. When the lockout count for a user account is reset to 0 due to either a successful authentication or an automatic reset, the registry subkey for the user account is deleted. To manually reset a user account that has been locked out before the failed attempts counter is automatically reset, delete the following registry subkey that corresponds to the user's account name: <strong>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RemoteAccess\Parameters\AccountLockout\</strong><em>domain name:user name</em></p>
              </td>
            </tr>
            <tr>
              <td>
                <p>65</p>
              </td>
              <td>
                <p>The <strong>Network Access Permission</strong> setting in the dial-in properties of the user account is set to <strong>Deny access</strong> to the user. </p>
                <p>To change the <strong>Network Access Permission</strong> setting to either <strong>Allow access</strong> or <strong>Control access through NPS Network Policy</strong>, obtain the properties of the user account in the Active Directory Users and Computers Microsoft Management Console (MMC) snap-in, click the <strong>Dial-in</strong> tab, and then change <strong>Network Access Permission</strong>.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>66</p>
              </td>
              <td>
                <p>Authentication failed. Either the client computer attempted to use an authentication method that is not enabled on the matching network policy or the client computer attempted to authenticate as Guest, but guest authentication is not enabled. To resolve this issue, ensure that all client computers are configured to use one or more authentication methods that are allowed by matching network policies.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>67</p>
              </td>
              <td>
                <p>NPS denied the connection request because the value of the Calling-Station-ID attribute in the Access-Request message did not match the value of <strong>Verify Caller ID</strong> in user account dial-in properties in the Active Directory Users and Computers snap-in.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>68</p>
              </td>
              <td>
                <p>The user or computer does not have permission to access the network on this day at this time. To change the day and time when the user is permitted to connect to the network, change the Day and Time Restrictions in the constraints of the matching network policy. For more information, see <a href="http://technet.microsoft.com/en-us/library/dd197618(v=ws.10).aspx">Constraints Properties</a>.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>69</p>
              </td>
              <td>
                <p>The telephone number of the network access server does not match the value of the Calling-Station-ID attribute that is configured in the constraints of the matching network policy. NPS denied the Access-Request message.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>70</p>
              </td>
              <td>
                <p>The network access method used by the access client to connect to the network does not match the value of the NAS-Port-Type attribute that is configured in the constraints of the matching network policy. NPS denied the Access-Request message.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>72</p>
              </td>
              <td>
                <p>The user password has expired or is about to expire and the user must change their password, however <strong>Authentication Methods</strong> in network policy constraints are not configured to allow the user to change their password. </p>
                <p>To allow the user to change their password, open the properties of the matching network policy, click the <strong>Constraints</strong> tab, click <strong>Authentication Methods</strong>, and then in the details pane select the appropriate authentication method and <strong>User can change password after it has expired</strong> check box.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>73</p>
              </td>
              <td>
                <p>The purposes that are configured in the Application Policies extensions, also called <em>Enhanced Key Usage (EKU) extensions</em>, section of the user or computer certificate are not valid or are missing. The user or computer certificate must be configured with the Client Authentication purpose in Application Policies extensions. The object identifier for Client Authentication is 1.3.6.1.5.5.7.3.2. </p>
                <p>To correct this problem, you must reconfigure the certificate template with the Client Authentication purpose in Application Policies extensions, revoke the old certificate, and enroll a new certificate that is configured correctly. For more information, see <a href="http://go.microsoft.com/fwlink/?LinkId=113884">Foundation Network Companion Guide: Deploying Computer and User Certificates</a> at http://go.microsoft.com/fwlink/?LinkId=113884.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>80</p>
              </td>
              <td>
                <p>NPS attempted to write accounting data to the data store (a log file on the local computer or a SQL Server database), but failed to do so for unknown reasons.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>96</p>
              </td>
              <td>
                <p>Authentication failed due to an Extensible Authentication Protocol (EAP) session timeout; the EAP session with the access client was incomplete.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>97</p>
              </td>
              <td>
                <p>The authentication request was not processed because it contained a Remote Authentication Dial-In User Service (RADIUS) message that was not appropriate for the secure authentication transaction.
</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>112</p>
              </td>
              <td>
                <p>The local NPS proxy server forwarded a connection request to a remote RADIUS server, and the remote server rejected the connection request. Check the event log on the remote RADIUS server to determine the reason that the connection request was rejected.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>113</p>
              </td>
              <td>
                <p>The local NPS proxy attempted to forward a connection request to a member of a remote RADIUS server group that does not exist. To resolve this issue, configure a valid remote RADIUS server group.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>115</p>
              </td>
              <td>
                <p>The local NPS proxy did not forward a RADIUS message because it is not an accounting request or a connection request.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>116</p>
              </td>
              <td>
                <p>The local NPS proxy server cannot forward the connection request to the remote RADIUS server because either the proxy cannot open a Windows socket over which to send the connection request, or the proxy server attempted to send the connection request but received Windows sockets errors that prevented successful completion of the send operation.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>117</p>
              </td>
              <td>
                <p>The remote RADIUS server did not respond to the local NPS proxy within an acceptable time period. Verify that the remote RADIUS server is available and functioning properly.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>118</p>
              </td>
              <td>
                <p>The local NPS proxy server received a RADIUS message that is malformed from a remote RADIUS server, and the message is unreadable. This issue can also be caused if a connection request contains more than the expected number of User-Name attributes, or if the User-Name attribute value is not valid, such as if the value has zero length or if it contains characters that are not valid.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>256</p>
              </td>
              <td>
                <p>The certificate provided by the user or computer as proof of their identity is a revoked certificate. Because of this, the user or computer was not authenticated, and NPS rejected the connection request.</p>
              </td>
            </tr>
            <tr>
              <td>
                <p>257</p>
              </td>
              <td>
                <p>Due to a missing dynamic link library (DLL) or exported function, NPS cannot access the certificate revocation list to verify whether the user or client computer certificate is valid or is revoked.
</p>
              </td>
            </tr>
          </table>
</body>
</html>
